<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø´ØºÙ„ ÙÙŠØ¯ÙŠÙˆ + Ù…Ù„Ø®Øµ Ø°ÙƒÙŠ</title>
  <style>
    body {
      text-align: right; /* [2] */
      font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* [2] */
      background-color: #f9f9f9; /* [2] */
      margin: 0; /* [2] */
      padding: 20px; /* [2] */
      transition: background-color 0.3s, color 0.3s; /* [2] */
    } /* [3] */
    #videoContainer, #summaryBox, #transcriptInput, .search-box, .notes-section { /* [3] */
      width: 90%; /* [3] */
      max-width: 900px; /* [3] */
      margin: 15px auto; /* [4] */
      text-align: right; /* [4] */
      font-size: 16px; /* [4] */
      line-height: 1.8; /* [4] */
      background-color: #fff; /* [4] */
      padding: 20px; /* [4] */
      border-radius: 8px; /* [4] */
      box-shadow: 0px 2px 5px rgba(0,0,0,0.2); /* [4] */
    } /* [5] */
    textarea { /* [5] */
      width: 100%; /* [5] */
      height: 150px; /* [5] */
      font-size: 16px; /* [5] */
      padding: 12px; /* [5] */
      margin-top: 10px; /* [6] */
      border: 1px solid #ddd; /* [6] */
      border-radius: 5px; /* [6] */
      transition: background-color 0.3s, color 0.3s; /* [6] */
      font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* [7] */
      text-align: right; /* [7] */
      direction: rtl; /* [7] */
    } /* [8] */
    input[type="text"] { /* [8] */
      width: 70%; /* [8] */
      padding: 12px; /* [8] */
      margin: 8px; /* [8] */
      border: 1px solid #ddd; /* [9] */
      border-radius: 5px; /* [9] */
      font-size: 16px; /* [9] */
      font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* [9] */
      text-align: right; /* [9] */
      direction: rtl; /* [9] */
    } /* [10] */
    .control-btn { /* [10] */
      padding: 12px 20px; /* [10] */
      margin: 10px; /* [10] */
      font-size: 16px; /* [10] */
      cursor: pointer; /* [10] */
      border: none; /* [11] */
      border-radius: 5px; /* [11] */
      background-color: #007bff; /* [11] */
      color: white; /* [11] */
      transition: 0.3s; /* [11] */
      box-shadow: 0px 2px 5px rgba(0,0,0,0.2); /* [11] */
      font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* [12] */
    }
    .control-btn:hover { /* [12] */
      background-color: #0056b3; /* [12] */
    } /* [13] */
    iframe { /* [13] */
      width: 100%; /* [13] */
      height: 450px; /* [13] */
      border-radius: 8px; /* [13] */
      border: none; /* [13] */
    } /* [14] */
    .floating-controls { /* [14] */
      position: fixed; /* [14] */
      bottom: 25px; /* [14] */
      left: 25px; /* [14] */
      display: flex; /* [14] */
      flex-direction: column; /* [15] */
      gap: 12px; /* [15] */
      z-index: 1000; /* [15] */
    }
    .floating-right-controls { /* [15] */
      position: fixed; /* [15] */
      bottom: 25px; /* [16] */
      right: 25px; /* [16] */
      display: flex; /* [16] */
      flex-direction: column; /* [16] */
      gap: 12px; /* [16] */
      z-index: 1000; /* [16] */
    } /* [17] */
    #notesList { /* [17] */
      list-style-type: none; /* [17] */
      padding: 0; /* [17] */
      width: 90%; /* [17] */
      max-width: 900px; /* [17] */
      margin: 20px auto; /* [18] */
    }
    #notesList li { /* [18] */
      background-color: #fff; /* [18] */
      padding: 15px; /* [18] */
      margin-bottom: 10px; /* [19] */
      border-radius: 5px; /* [19] */
      box-shadow: 0px 1px 3px rgba(0,0,0,0.1); /* [19] */
      text-align: right; /* [19] */
      font-size: 15px; /* [19] */
      line-height: 1.6; /* [19] */
    } /* [20] */
    .speed-controls { /* [20] */
      display: flex; /* [20] */
      flex-wrap: wrap; /* [20] */
      justify-content: center; /* [20] */
      gap: 10px; /* [20] */
      margin-top: 20px; /* [21] */
    }
    .speed-btn { /* [21] */
      min-width: 65px; /* [21] */
      padding: 12px; /* [21] */
    } /* [22] */
    .clear-search-btn { /* [22] */
      padding: 12px 18px; /* [22] */
      margin: 10px; /* [22] */
      font-size: 15px; /* [22] */
      cursor: pointer; /* [22] */
      border: none; /* [23] */
      border-radius: 5px; /* [23] */
      background-color: #dc3545; /* [23] */
      color: white; /* [23] */
      transition: 0.3s; /* [23] */
      box-shadow: 0px 2px 5px rgba(0,0,0,0.2); /* [23] */
      font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* [24] */
    }
    .clear-search-btn:hover { /* [24] */
      background-color: #c82333; /* [24] */
    } /* [25] */

    /* Dark Mode Styles */
    .dark-mode { /* [25] */
      background-color: #121212; /* [25] */
      color: #e0e0e0; /* [26] */
    }
    .dark-mode #videoContainer, /* [26] */
    .dark-mode #summaryBox, /* [26] */
    .dark-mode #transcriptInput, /* [26] */
    .dark-mode .search-box, /* [26] */
    .dark-mode .notes-section { /* [26] */
      background-color: #1e1e1e; /* [26] */
      color: #e0e0e0; /* [27] */
      border: 1px solid #333; /* [27] */
    }
    .dark-mode textarea { /* [27] */
      background-color: #2d2d2d; /* [27] */
      color: #e0e0e0; /* [28] */
      border: 1px solid #444; /* [28] */
    }
    .dark-mode input[type="text"] { /* [28] */
      background-color: #2d2d2d; /* [28] */
      color: #e0e0e0; /* [29] */
      border: 1px solid #444; /* [29] */
    }
    .dark-mode .control-btn { /* [29] */
      background-color: #444; /* [29] */
      color: #fff; /* [30] */
    }
    .dark-mode .control-btn:hover { /* [30] */
      background-color: #555; /* [30] */
    } /* [31] */
    .dark-mode #notesList li { /* [31] */
      background-color: #2d2d2d; /* [31] */
      color: #e0e0e0; /* [31] */
      border: 1px solid #444; /* [32] */
    }
    .dark-mode .clear-search-btn { /* [32] */
      background-color: #a71d2a; /* [32] */
    } /* [33] */
    .dark-mode .clear-search-btn:hover { /* [33] */
      background-color: #8c1a24; /* [33] */
    } /* [34] */

    /* Highlight Styles */
    .highlight { /* [34] */
      background-color: yellow; /* [34] */
      color: black; /* [35] */
      padding: 0 3px; /* [35] */
      border-radius: 3px; /* [35] */
    }
    .highlight-line { /* [35] */
      background-color: rgba(255, 255, 0, 0.3); /* [35] */
      border-left: 4px solid yellow; /* [36] */
      padding: 10px; /* [36] */
      margin: 10px 0; /* [36] */
      cursor: pointer; /* [36] */
      border-radius: 0 6px 6px 0; /* [36] */
    } /* [37] */
    .highlight-line:hover { /* [37] */
      background-color: rgba(255, 255, 0, 0.5); /* [37] */
    } /* [38] */

    /* Summary Box Styles */
    #summaryBox { /* [38] */
      text-align: right; /* [38] */
      white-space: normal; /* [39] */
      font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* [39] */
      line-height: 1.8; /* [39] */
      padding: 20px; /* [39] */
      overflow-wrap: break-word; /* [39] */
    } /* [40] */
    #summaryBox b { /* [40] */
      font-weight: bold; /* [40] */
      color: #007bff; /* [40] */
    } /* [41] */
    #summaryBox i { /* [41] */
      font-style: italic; /* [41] */
    } /* [42] */
    #summaryBox u { /* [42] */
      text-decoration: underline; /* [42] */
    } /* [43] */
    .note-link { /* [43] */
      color: #007bff; /* [43] */
      cursor: pointer; /* [43] */
      text-decoration: underline; /* [43] */
    } /* [44] */

    /* LaTeX Styles */
    .latex { /* [44] */
      color: #d63384; /* [44] */
      font-family: "Courier New", monospace; /* [45] */
      background-color: rgba(214, 51, 132, 0.1); /* [45] */
      padding: 2px 8px; /* [45] */
      border-radius: 4px; /* [45] */
      font-size: 1.1em; /* [45] */
    } /* [46] */
    .math-container { /* [46] */
      margin: 20px 0; /* [46] */
      padding: 15px; /* [46] */
      background-color: rgba(248, 249, 250, 0.7); /* [47] */
      border-radius: 6px; /* [47] */
      border-left: 5px solid #d63384; /* [47] */
      overflow-x: auto; /* [47] */
      text-align: center; /* [47] */
    } /* [48] */
    .dark-mode .latex { /* [48] */
      color: #ff6b9e; /* [48] */
      background-color: rgba(255, 107, 158, 0.1); /* [48] */
    } /* [49] */
    .dark-mode .math-container { /* [49] */
      background-color: rgba(30, 30, 30, 0.7); /* [49] */
      border-left-color: #ff6b9e; /* [49] */
    } /* [50] */

    /* Summary Sections */
    .summary-section { /* [50] */
      background-color: rgba(0, 123, 255, 0.05); /* [50] */
      border-left: 5px solid #007bff; /* [51] */
      padding: 15px; /* [51] */
      margin: 20px 0; /* [51] */
      border-radius: 0 6px 6px 0; /* [51] */
    } /* [52] */
    .summary-title { /* [52] */
      color: #007bff; /* [52] */
      font-weight: bold; /* [52] */
      margin-bottom: 10px; /* [52] */
      font-size: 18px; /* [52] */
    } /* [53] */
    .summary-laws { /* [53] */
      background-color: rgba(23, 162, 184, 0.05); /* [53] */
      border-left: 5px solid #17a2b8; /* [53] */
      padding: 12px; /* [54] */
      margin: 15px 0; /* [54] */
      border-radius: 0 6px 6px 0; /* [54] */
    } /* [55] */
    .law-title { /* [55] */
      color: #17a2b8; /* [55] */
      font-weight: bold; /* [55] */
      margin-bottom: 8px; /* [55] */
      font-size: 16px; /* [55] */
    } /* [56] */
    .dark-mode .summary-section { /* [56] */
      background-color: rgba(0, 123, 255, 0.1); /* [56] */
    } /* [57] */
    .dark-mode .summary-laws { /* [57] */
      background-color: rgba(23, 162, 184, 0.1); /* [57] */
    } /* [58] */
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

  <h2 style="margin-bottom: 25px; color: #007bff;">ğŸ“º Ù…Ø´ØºÙ„ ÙÙŠØ¯ÙŠÙˆ Ù…ØªÙƒØ§Ù…Ù„ + ØªÙ„Ø®ÙŠØµ Ø°ÙƒÙŠ</h2>

  <div style="margin-bottom: 25px;">
    <input type="text" id="videoUrl" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨" style="width: 65%; padding: 12px;">
    <button class="control-btn" onclick="loadVideo()">ğŸ¬ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
  </div>

  <div id="videoContainer"></div>

  <div class="speed-controls">
    <button class="control-btn speed-btn" onclick="changeSpeed(0.5)">0.5x</button>
    <button class="control-btn speed-btn" onclick="changeSpeed(0.75)">0.75x</button>
    <button class="control-btn speed-btn" onclick="changeSpeed(1)">1x</button>
    <button class="control-btn speed-btn" onclick="changeSpeed(1.25)">1.25x</button>
    <button class="control-btn speed-btn" onclick="changeSpeed(1.5)">1.5x</button>
    <button class="control-btn speed-btn" onclick="changeSpeed(2)">2x</button>
  </div> /* [59] */

  <div class="floating-controls">
    <button class="control-btn" onclick="seek(-10)">âª Ø±Ø¬ÙˆØ¹ 10 Ø«ÙˆØ§Ù†Ù</button>
    <button class="control-btn" onclick="seek(10)">â© ØªÙ‚Ø¯ÙŠÙ… 10 Ø«ÙˆØ§Ù†Ù</button>
  </div>

  <div class="floating-right-controls">
    <button class="control-btn" id="playPauseBtn" onclick="togglePlayPause()">â¸ Ø¥ÙŠÙ‚Ø§Ù</button>
  </div>

  <div class="notes-section">
    <h3 style="margin-top: 0; color: #17a2b8;">ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</h3> /* [60] */
    <textarea id="noteText" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ù†Ø§..."></textarea>
    <button class="control-btn" onclick="saveNote()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</button>
  </div>

  <ul id="notesList"></ul> /* [18] */

  <div class="search-box">
    <h3 style="margin-top: 0; color: #d63384;">ğŸ” Ø¨Ø­Ø« ÙÙŠ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h3> /* [61] */
    <input type="text" id="searchText" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ù†Øµ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ...">
    <button class="control-btn" onclick="searchInText()">Ø¨Ø­Ø«</button>
    <button class="clear-search-btn" onclick="clearSearch()" id="clearSearchBtn" style="display:none;">âœ– Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¨Ø­Ø«</button>
    <div id="searchResults" style="margin-top: 15px; text-align: right;"></div> /* [62] */
  </div>

  <div style="margin-top: 25px;">
    <h3 style="margin-bottom: 15px; color: #6f42c1;">ğŸ“Œ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ ÙŠØ¯ÙˆÙŠÙ‹Ø§:</h3> /* [63] */
    <textarea id="transcriptInput" placeholder="Ø§Ù†ØªØ¸Ø± Ø¬Ù„Ø¨ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø£Ùˆ Ø§Ù„ØµÙ‚Ù‡Ø§ Ù‡Ù†Ø§..." style="height: 180px;"></textarea>
    <button class="control-btn" onclick="summarizeText()" style="margin-top: 15px;">ğŸ“ ØªÙˆÙ„ÙŠØ¯ Ù…Ù„Ø®Øµ</button>
  </div>

  <div id="summaryBox" style="margin-top: 25px; min-height: 150px;">ğŸ” Ù„Ù… ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ù…Ù„Ø®Øµ Ø¨Ø¹Ø¯.</div> /* [64] */

  <button class="control-btn" onclick="toggleDarkMode()" style="margin: 25px auto; padding: 12px 25px;">ğŸŒ™ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</button> /* [65] */

  <script>
    const OPENROUTER_API_KEY = "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"; // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ø®Ø§Øµ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
    let player;
    let notes = [];
    let captionsData = [];
    let isPlaying = false; // Ø§Ø¨Ø¯Ø£ Ø¨Ø­Ø§Ù„Ø© Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§
    let currentHighlights = {}; // ØªÙ‡ÙŠØ¦Ø© ÙƒÙƒØ§Ø¦Ù† ÙØ§Ø±Øº
    let playerReady = false;

    // 1. ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© ÙŠÙˆØªÙŠÙˆØ¨
    function loadYouTubeAPI() {
      const tag = document.createElement('script');
      // !!! ØªØµØ­ÙŠØ­ Ø§Ù„Ø±Ø§Ø¨Ø· !!!
      tag.src = "https://www.youtube.com/iframe_api";
      const firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    }

    // 2. Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø³ØªÙØ³ØªØ¯Ø¹Ù‰ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„Ù‡Ø§
    function onYouTubeIframeAPIReady() { /* [66] */
      console.log("YouTube API Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¹Ù…Ù„");
      // Ù„Ø§ Ù†Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø´ØºÙ„ Ù‡Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ø¨Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
    }

    // 3. Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ù…Ø´ØºÙ„
    function isPlayerReady() {
      // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø´ØºÙ„ Ù„ÙŠØ³ ÙÙ‚Ø· Ù…Ø¹Ø±ÙÙ‹Ø§ØŒ Ø¨Ù„ Ù„Ø¯ÙŠÙ‡ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù„Ø§Ø²Ù…Ø© ÙˆØ£Ù† playerReady true
      return playerReady && player && typeof player.getPlayerState === 'function'; /* [65] */
    }

    // 4. Ø¯Ø§Ù„Ø© Ù…Ù†ÙØµÙ„Ø© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ø¯Ø« onReady Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø´ØºÙ„
    function onPlayerReady(event) {
      console.log("Ø§Ù„Ù…Ø´ØºÙ„ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… (onReady event fired)");
      player = event.target; /* [69] */ // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø´ØºÙ„
      playerReady = true; /* [71] */
      // Ù„Ø§ ØªÙ‚Ù… Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù‡Ù†Ø§ Ø¥Ù„Ø§ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø°Ù„Ùƒ
      // player.playVideo();
      // isPlaying = true; // Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© onStateChange
      updatePlayPauseButton(); // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø±
    }

    // 5. Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
    function loadVideo() {
      const url = document.getElementById("videoUrl").value;
      const videoId = extractVideoID(url);
      if (!videoId) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ ØµØ­ÙŠØ­");
        return;
      }

      // Ø¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø£Ù† Ø§Ù„Ù…Ø´ØºÙ„ Ù„ÙŠØ³ Ø¬Ø§Ù‡Ø²Ù‹Ø§ Ø¨Ø¹Ø¯ (Ø£Ùˆ Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„)
      playerReady = false; /* [67] */
      isPlaying = false; // Ø§ÙØªØ±Ø¶ Ø£Ù†Ù‡ Ù…ØªÙˆÙ‚Ù Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯
      updatePlayPauseButton(); // Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø²Ø± Ù„ÙŠØ¹ÙƒØ³ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©

      if (player && typeof player.loadVideoById === 'function') {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø´ØºÙ„ Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ø¨Ø§Ù„ÙØ¹Ù„ØŒ ÙÙ‚Ø· Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯
        console.log("Ø§Ù„Ù…Ø´ØºÙ„ Ù…ÙˆØ¬ÙˆØ¯ØŒ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯:", videoId);
        // Ù„Ø§ Ù†Ù‚Ù… Ø¨Ù€ player.destroy() Ø¥Ù„Ø§ Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ù…Ø´Ø§ÙƒÙ„ØŒ loadVideoById Ø¹Ø§Ø¯Ø© ÙƒØ§ÙÙŠØ©
        player.loadVideoById(videoId);
        // onReady Ø³ØªÙØ³ØªØ¯Ø¹Ù‰ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
      } else {
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ù…Ø´ØºÙ„ Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ØŒ Ø£Ùˆ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ù…Ø´ÙƒÙ„Ø©ØŒ Ø£Ù†Ø´Ø¦ ÙˆØ§Ø­Ø¯Ù‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§
        console.log("Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´ØºÙ„ ÙŠÙˆØªÙŠÙˆØ¨ Ø¬Ø¯ÙŠØ¯ Ù„Ù„ÙÙŠØ¯ÙŠÙˆ:", videoId);
        // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø­Ø§ÙˆÙŠØ© ÙØ§Ø±ØºØ© Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ù…Ø´ØºÙ„ Ø¬Ø¯ÙŠØ¯
        document.getElementById("videoContainer").innerHTML = '<div id="youtubePlayer"></div>'; /* [67] */
        player = new YT.Player('youtubePlayer', { /* [70] */
          height: '450', /* [70] */
          width: '100%', /* [70] */
          videoId: videoId, /* [70] */
          playerVars: {
              'playsinline': 1 // Ù…Ù‡Ù… Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø¶Ù…Ù†Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„
          },
          events: { /* [70] */
              'onReady': onPlayerReady, // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ù†ÙØµÙ„Ø© Ù„Ù„Ø¬Ø§Ù‡Ø²ÙŠØ© /* [71] */
              'onStateChange': onPlayerStateChange /* [71] */
          }
        });
      } /* [72] */

      fetchTranscript(videoId);
    } /* [73] */

    function extractVideoID(url) {
      // ØªØ­Ø³ÙŠÙ† Ø·ÙÙŠÙ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø±ÙˆØ§Ø¨Ø· shorts ÙˆØ±ÙˆØ§Ø¨Ø· Ø£Ø®Ø±Ù‰ Ù…Ø­ØªÙ…Ù„Ø©
      const patterns = [
          /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/|youtube\.com\/shorts\/)([^"&?\/\s]{11})/i
      ];
      for (const pattern of patterns) {
        const match = url.match(pattern);
        if (match && match[1]) {
          return match[1]; /* [74] */
        }
      }
      return null;
    }

    function onPlayerStateChange(event) {
      if (event.data == YT.PlayerState.PLAYING) { /* [74] */
        isPlaying = true; /* [74] */
      } else if (event.data == YT.PlayerState.PAUSED || event.data == YT.PlayerState.ENDED) { /* [75] */
        isPlaying = false; /* [75] */
      } /* [76] */
      updatePlayPauseButton(); /* [76] */
    }

    function togglePlayPause() {
      if (!isPlayerReady()) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆØ¬Ø§Ù‡Ø²ÙŠØªÙ‡"); /* [76] */
        return; /* [77] */
      }
      try {
        if (player.getPlayerState() === YT.PlayerState.PLAYING) { /* [77] */
          player.pauseVideo(); /* [77] */
          // isPlaying Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© onPlayerStateChange
        } else { /* [78] */
          player.playVideo(); /* [78] */
          // isPlaying Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© onPlayerStateChange
        } /* [79] */
        // updatePlayPauseButton(); // ØªÙ… Ù†Ù‚Ù„Ù‡Ø§ Ø¥Ù„Ù‰ onPlayerStateChange
      } catch (e) { /* [79] */
        console.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…Ø´ØºÙ„:", e); /* [79] */
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…Ø´ØºÙ„"); /* [80] */
      }
    }

    function updatePlayPauseButton() {
      const btn = document.getElementById("playPauseBtn"); /* [80] */
      if (!playerReady) {
          btn.innerHTML = "â³ ØªØ­Ù…ÙŠÙ„..."; // Ø£Ùˆ Ø£ÙŠ Ù†Øµ ÙŠØ´ÙŠØ± Ù„Ø¹Ø¯Ù… Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©
          btn.disabled = true; // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ù…Ø¤Ù‚ØªÙ‹Ø§
      } else if (isPlaying) { /* [81] */
        btn.innerHTML = "â¸ Ø¥ÙŠÙ‚Ø§Ù"; /* [81] */
        btn.disabled = false;
      } else { /* [82] */
        btn.innerHTML = "â–¶ ØªØ´ØºÙŠÙ„"; /* [82] */
        btn.disabled = false;
      } /* [83] */
    }

    function changeSpeed(speed) {
      if (!isPlayerReady()) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆØ¬Ø§Ù‡Ø²ÙŠØªÙ‡"); /* [83] */
        return; /* [84] */
      }
      try {
        player.setPlaybackRate(speed); /* [84] */
        console.log("ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø© Ø¥Ù„Ù‰:", speed); /* [85] */
      } catch (e) { /* [85] */
        console.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø©:", e); /* [85] */
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø©"); /* [86] */
      }
    }

    function seek(seconds) {
      if (!isPlayerReady()) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆØ¬Ø§Ù‡Ø²ÙŠØªÙ‡"); /* [86] */
        return; /* [87] */
      }
      try {
        let currentTime = player.getCurrentTime(); /* [87] */
        let newTime = currentTime + seconds; /* [88] */
        if (newTime < 0) newTime = 0; /* [88] */
        // ØªØ­Ù‚Ù‚ Ø£ÙŠØ¶Ù‹Ø§ Ù…Ù† Ø£Ù„Ø§ ØªØªØ¬Ø§ÙˆØ² Ù…Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„ÙƒÙ† Ø¬ÙŠØ¯)
        // const duration = player.getDuration();
        // if (newTime > duration) newTime = duration;
        player.seekTo(newTime, true); /* [88] */
        console.log("ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰:", newTime); /* [88] */
      } catch (e) { /* [89] */
        console.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„:", e); /* [89] */
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„"); /* [90] */
      }
    }

    // --- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¯ÙˆØ§Ù„ (fetchTranscript, searchInText, summarizeText, Ø¥Ù„Ø®) ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ ---

    async function fetchTranscript(videoId) {
      document.getElementById("transcriptInput").value = "â³ Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªØ±Ø¬Ù…Ø©..."; /* [90] */
      try { /* [91] */
        // Ù…Ø«Ø§Ù„ Ù„Ù†Øµ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨API Ø­Ù‚ÙŠÙ‚ÙŠ)
        // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¬Ù„Ø¨ Ø§Ù„ØªØ±Ø¬Ù…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† ÙŠÙˆØªÙŠÙˆØ¨ ÙŠØªØ·Ù„Ø¨ API Ø£ÙƒØ«Ø± ØªØ¹Ù‚ÙŠØ¯Ù‹Ø§ Ø£Ùˆ Ø®Ø¯Ù…Ø© Ø®Ø§Ø±Ø¬ÙŠØ©
        // Ø³Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø¶Ù…Ù† ÙƒÙ…Ø«Ø§Ù„ Ø§Ù„Ø¢Ù†
        const mockTranscript = `1. Ù…Ù‚Ø¯Ù…Ø© Ø¹Ù† Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ /* [91] */
ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø±Ø³ Ø³Ù†ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙˆØ§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ. /* [92] */
2. Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ /* [93] */
Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ (I) Ù‡Ùˆ Ù…Ø¹Ø¯Ù„ ØªØ¯ÙÙ‚ Ø§Ù„Ø´Ø­Ù†Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© (Q) Ø®Ù„Ø§Ù„ Ø§Ù„Ø²Ù…Ù† (t) Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†: /* [93] */
\\( I = \\frac{Q}{t} \\) /* [93] */

ÙˆØ­Ø¯Ø© Ù‚ÙŠØ§Ø³ Ø§Ù„ØªÙŠØ§Ø± Ù‡ÙŠ Ø§Ù„Ø£Ù…Ø¨ÙŠØ± (A). /* [93] */
3. Ù‚Ø§Ù†ÙˆÙ† Ø£ÙˆÙ… /* [94] */
ÙŠÙ†Øµ Ù‚Ø§Ù†ÙˆÙ† Ø£ÙˆÙ… Ø¹Ù„Ù‰ Ø£Ù† Ø§Ù„Ø¬Ù‡Ø¯ (V) Ø¹Ø¨Ø± Ù…ÙˆØµÙ„ ÙŠØªÙ†Ø§Ø³Ø¨ Ø·Ø±Ø¯ÙŠØ§Ù‹ Ù…Ø¹ Ø§Ù„ØªÙŠØ§Ø± (I) Ø§Ù„Ù…Ø§Ø± ÙÙŠÙ‡: /* [94] */
\\[ V = I \\times R \\] /* [94] */
Ø­ÙŠØ« R Ù‡ÙŠ Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø© ÙˆØªÙ‚Ø§Ø³ Ø¨Ø§Ù„Ø£ÙˆÙ… (Î©). /* [94] */
4. ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¹Ù…Ù„ÙŠØ© /* [95] */
Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙ†Ø§ Ø³Ù„Ùƒ Ø·ÙˆÙ„Ù‡ L1 ÙˆÙ…Ø³Ø§Ø­Ø© Ù…Ù‚Ø·Ø¹Ù‡ A1 ÙˆÙ…Ù‚Ø§ÙˆÙ…ØªÙ‡ R1ØŒ ÙˆØ¹Ù†Ø¯Ù…Ø§ ÙŠØµØ¨Ø­ Ø·ÙˆÙ„ Ø§Ù„Ø³Ù„Ùƒ \\( L2 = 2L1 \\)), ØªØµØ¨Ø­ Ø§Ù„Ù…Ø³Ø§Ø­Ø© \\( A2 = \\frac{A1}{2} \\). /* [95] */
Ø§Ù„Ù…Ù‚Ø§ÙˆÙ…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©: /* [96] */
\\[ /* [96] */
R2 = \\rho \\frac{2L1}{\\frac{A1}{2}} = 4R1 /* [96] */
\\]`; /* [96] */

        // Ù…Ø«Ø§Ù„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆÙ‚Øª Ù„Ù„Ù†Øµ (ÙŠØ¬Ø¨ Ø£Ù† ØªØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ)
        captionsData = [
          { time: 5, text: "Ù…Ù‚Ø¯Ù…Ø© Ø¹Ù† Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡" }, /* [96] */
          { time: 15, text: "Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ" }, /* [96] */
          { time: 25, text: "Ù‚Ø§Ù†ÙˆÙ† Ø£ÙˆÙ…" }, /* [96] */
          { time: 35, text: "ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø¹Ù…Ù„ÙŠØ©" } /* [96] */
        ];
        document.getElementById("transcriptInput").value = mockTranscript; /* [97] */
      } catch (error) { /* [97] */
        document.getElementById("transcriptInput").value = "âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„ØªØ±Ø¬Ù…Ø©ØŒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ ÙŠØ¯ÙˆÙŠÙ‹Ø§."; /* [97] */
        console.error("Ø®Ø·Ø£ Ø¬Ù„Ø¨ Ø§Ù„ØªØ±Ø¬Ù…Ø©:", error);
      } /* [98] */
    }

    function searchInText() {
      const query = document.getElementById("searchText").value.trim(); /* [98] */
      if (!query) return alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ù„Ù„Ø¨Ø­Ø«"); /* [99] */

      const transcriptArea = document.getElementById("transcriptInput");
      let transcript = transcriptArea.value; /* [99] */
      if (!transcript) return alert("âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Øµ Ù„Ù„Ø¨Ø­Ø« ÙÙŠÙ‡"); /* [100] */

      // Ø£Ø²Ù„ Ø§Ù„ØªØ¸Ù„ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬Ø¯ÙŠØ¯
      removeHighlights();
      transcript = document.getElementById("transcriptInput").value; // Ø£Ø¹Ø¯ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ

      const lines = transcript.split('\n'); /* [100] */
      let resultsHTML = ''; /* [100] */
      let foundCount = 0; /* [101] */
      let firstMatchLineIndex = -1;

      lines.forEach((line, index) => { /* [101] */
        if (line.toLowerCase().includes(query.toLowerCase())) { /* [101] */
          foundCount++; /* [101] */
          if (firstMatchLineIndex === -1) {
              firstMatchLineIndex = index;
          }
          // Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù… highlightText Ù‡Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ø³Ù†Ù‚ÙˆÙ… Ø¨ØªØ¸Ù„ÙŠÙ„ Ø§Ù„ÙƒÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
          // ÙˆÙ†Ø¹Ø±Ø¶ ÙÙ‚Ø· Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ ÙÙŠ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„ØªØ¬Ù†Ø¨ ØªØ¯Ø§Ø®Ù„ Ø§Ù„Ù€ HTML
          resultsHTML += `<div class="highlight-line" onclick="jumpToLineAndHighlight(${index})">
            <b>Ø§Ù„Ø³Ø·Ø± ${index + 1}:</b> ${escapeHtml(line)}
          </div>`; /* [101] */
        }
      }); /* [101] */

      if (foundCount > 0) { /* [102] */
        document.getElementById("searchResults").innerHTML = `
          <p>ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${foundCount} Ù†ØªØ§Ø¦Ø¬:</p>
          ${resultsHTML}
        `; /* [102] */
        // Ù‚Ù… Ø¨ØªØ¸Ù„ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ù†Øµ
        highlightAllOccurrences(transcript, query); /* [103] */
        document.getElementById("clearSearchBtn").style.display = 'inline-block'; /* [103] */
        if (firstMatchLineIndex >= 0) { /* [105] */
            // Ù„Ø§ ØªÙ‚Ù… Ø¨Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù‡Ù†Ø§ØŒ Ø§ØªØ±ÙƒÙ‡ Ù„Ù€ jumpToLineAndHighlight
        } /* [106] */
      } else { /* [106] */
        document.getElementById("searchResults").innerHTML = "âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬"; /* [106] */
        document.getElementById("clearSearchBtn").style.display = 'none'; /* [107] */
      }
    }

    // Ø¯Ø§Ù„Ø© Ù„Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† HTML Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    function escapeHtml(unsafe) {
        return unsafe
             .replace(/&/g, "&amp;")
             .replace(/</g, "&lt;")
             .replace(/>/g, "&gt;")
             .replace(/"/g, "&quot;")
             .replace(/'/g, "&#039;");
     }

    // Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù‚ÙØ² Ù„Ù„Ø³Ø·Ø± ÙˆØªØ¸Ù„ÙŠÙ„Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¨Ø­Ø«
    function jumpToLineAndHighlight(lineNumber) {
        scrollToLine(lineNumber); // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø·Ø±
        // Ø£Ø¶Ù Ù‡Ù†Ø§ Ù…Ù†Ø·Ù‚ Ø§Ù„Ù‚ÙØ² ÙÙŠ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ø¨ÙŠØ§Ù†Ø§Øª ØªÙˆØ§ÙÙ‚ Ø§Ù„Ø£Ø³Ø·Ø± Ù…Ø¹ Ø§Ù„ÙˆÙ‚Øª
        // const time = findTimeForLine(lineNumber);
        // if (time !== null) {
        //    jumpTo(time);
        // }
    }

    function clearSearch() {
      removeHighlights(); /* [107] */
      document.getElementById("clearSearchBtn").style.display = 'none'; /* [108] */
      document.getElementById("searchResults").innerHTML = ''; /* [108] */
      document.getElementById("searchText").value = ''; /* [108] */
    }

    // Ù„Ø§ ØªØ¹Ø¯Ù„ Ø§Ù„Ù†Øµ Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ø¨Ù„ Ø®Ø²Ù† Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø¸Ù„Ù„ Ù…Ù†ÙØµÙ„Ø§Ù‹
    function highlightAllOccurrences(text, query) {
      const regex = new RegExp(`(${escapeRegExp(query)})`, 'gi'); /* [108] */
      const highlightedText = text.replace(regex, '<span class="highlight">$1</span>'); /* [109] */

      // Ø¹Ø±Ø¶ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø¸Ù„Ù„ (ÙŠÙ…ÙƒÙ† Ø¹Ø±Ø¶Ù‡ ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø± Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø£Ø®Ø±Ù‰)
      // Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªØ­Ø±ÙŠØ±ØŒ Ù„Ø§ Ù†Ø¶Ø¹Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ textarea
      // currentHighlights.highlightedText = highlightedText;
      // document.getElementById("transcriptInput").value = highlightedText; // ØªØ¬Ù†Ø¨ Ù‡Ø°Ø§

      // Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„ÙƒØŒ ÙŠÙ…ÙƒÙ†Ù†Ø§ ÙÙ‚Ø· ØªØªØ¨Ø¹ Ø£Ù…Ø§ÙƒÙ† Ø§Ù„ØªØ¸Ù„ÙŠÙ„
      currentHighlights.query = query;
      currentHighlights.originalText = text;

      // ÙŠÙ…ÙƒÙ†Ùƒ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¸Ù„ÙŠÙ„ ÙÙŠ Ø¹Ù†ØµØ± Ø¹Ø±Ø¶ Ù…Ù†ÙØµÙ„ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª
      // document.getElementById("highlightedDisplay").innerHTML = highlightedText;

      // Ø£Ùˆ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¸Ù„ÙŠÙ„ Ù…Ø¤Ù‚ØªÙ‹Ø§ Ø¹Ù„Ù‰ textarea Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ§Øª CSS Ø£ÙƒØ«Ø± ØªØ¹Ù‚ÙŠØ¯Ù‹Ø§ (Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø­Ø§Ù„ÙŠ)
    } /* [113] */

    function escapeRegExp(string) {
      return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); /* [113] */
    } /* [114] */

    function removeHighlights() {
      // Ø¥Ø°Ø§ ÙƒÙ†Ø§ Ù†Ø®Ø²Ù† Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠØŒ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø§Ø³ØªØ¹Ø§Ø¯ØªÙ‡
      if (currentHighlights.originalText) {
         document.getElementById("transcriptInput").value = currentHighlights.originalText; /* [115] */
      }
      // Ù…Ø³Ø­ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ¸Ù„ÙŠÙ„
      currentHighlights = {}; /* [115] */
      // Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… Ø¹Ù†ØµØ± Ø¹Ø±Ø¶ Ù…Ù†ÙØµÙ„ØŒ Ù‚Ù… Ø¨Ù…Ø³Ø­Ù‡
      // document.getElementById("highlightedDisplay").innerHTML = '';
    } /* [116] */

    function scrollToLine(lineNumber) {
      const textarea = document.getElementById("transcriptInput"); /* [116] */
      const lines = textarea.value.split('\n'); /* [116] */
      if (lineNumber >= lines.length) return; // ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ø³Ø·Ø±

      let position = 0; /* [117] */
      for (let i = 0; i < lineNumber; i++) { /* [117] */
        position += lines[i].length + 1; // +1 Ù„Ø­Ø±Ù Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ /* [117] */
      } /* [118] */

      textarea.focus(); /* [118] */
      textarea.scrollTop = 0; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¯ ÙŠØ³Ø§Ø¹Ø¯

      // Ø­Ø³Ø§Ø¨ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø³Ø·Ø± Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ Ù„Ù„ØªÙ…Ø±ÙŠØ±
      const avgLineHeight = textarea.scrollHeight / lines.length;
      const scrollToPosition = lineNumber * avgLineHeight - (textarea.clientHeight / 3); // Ø­Ø§ÙˆÙ„ Ø§Ù„ØªÙˆØ³ÙŠØ·
      textarea.scrollTop = Math.max(0, scrollToPosition);

      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†Øµ ÙˆØªØ¸Ù„ÙŠÙ„Ù‡ Ù…Ø¤Ù‚ØªÙ‹Ø§
      const endPosition = position + lines[lineNumber].length;
      textarea.setSelectionRange(position, endPosition); /* [118] */

      // ØªØ¸Ù„ÙŠÙ„ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…Ø¤Ù‚Øª (Ù‚Ø¯ Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø«Ø§Ù„ÙŠ ÙÙŠ ÙƒÙ„ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª Ù…Ø¹ scrollTop)
      textarea.style.transition = 'background-color 0.2s ease-in-out';
      textarea.style.backgroundColor = 'rgba(255, 255, 0, 0.3)'; /* [118] */
      setTimeout(() => { /* [119] */
        textarea.style.backgroundColor = ''; /* [119] */
      }, 1500); /* [119] */
    } /* [120] */

    async function summarizeText() {
      const text = document.getElementById("transcriptInput").value; /* [120] */
      if (!text || text.trim() === "" || text.includes("â³")) return alert("âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø£Ùˆ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø¬Ù„Ø¨Ù‡."); /* [121] */

      document.getElementById("summaryBox").innerHTML = "â³ Ø¬Ø§Ø±ÙŠ ØªÙ„Ø®ÙŠØµ Ø§Ù„Ù…Ø­ØªÙˆÙ‰..."; /* [121] */
      try { /* [122] */
        const response = await fetch("https://openrouter.ai/api/v1/chat/completions", { /* [122] */
          method: "POST", /* [122] */
          headers: { /* [122] */
            "Authorization": `Bearer ${OPENROUTER_API_KEY}`, /* [122] */
            "Content-Type": "application/json", /* [122] */
            // Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ù„Ø¥Ø¶Ø§ÙØ© Ù‡Ø°ÙŠÙ† Ø§Ù„Ø³Ø·Ø±ÙŠÙ† Ø­Ø³Ø¨ Ù…ØªØ·Ù„Ø¨Ø§Øª OpenRouter
            // "HTTP-Referer": window.location.href, // Ø£Ùˆ Ø¹Ù†ÙˆØ§Ù† Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø«Ø§Ø¨Øª
            // "X-Title": document.title // Ø£Ùˆ Ø§Ø³Ù… Ù…ÙˆÙ‚Ø¹Ùƒ
          },
          body: JSON.stringify({ /* [123] */
            "model": "anthropic/claude-3-haiku-20240307", // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ù…ÙˆØ°Ø¬ Ø£Ø³Ø±Ø¹ ÙˆØ£Ø±Ø®Øµ Ù…Ø«Ù„ Haiku
            "messages": [{ /* [123] */
              "role": "user", /* [123] */
              "content": `Ù‚Ù… Ø¨ØªÙ„Ø®ÙŠØµ Ù‡Ø°Ø§ Ø§Ù„Ù†Øµ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ù‡Ø§Ù…Ø©.
              Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª Ø£ÙŠ Ù‚ÙˆØ§Ù†ÙŠÙ† Ø£Ùˆ Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø±ÙŠØ§Ø¶ÙŠØ©ØŒ Ø£Ø¨Ø±Ø²Ù‡Ø§ Ø¨ÙˆØ¶ÙˆØ­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ØµÙŠØºØ© LaTeX. Ù„Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³Ø·Ø± Ø§Ø³ØªØ®Ø¯Ù… \\( ... \\) ÙˆÙ„Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„ Ø§Ø³ØªØ®Ø¯Ù… \\[ ... \\].
              Ù†Ø¸Ù… Ø§Ù„Ù…Ù„Ø®Øµ ÙÙŠ ÙÙ‚Ø±Ø§Øª ÙˆØ§Ø¶Ø­Ø©ØŒ ÙˆÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙˆØ§Ù„Ù†Ù‚Ø§Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø°Ù„Ùƒ Ù…Ù†Ø§Ø³Ø¨Ù‹Ø§ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©.
              ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ØµÙŠØ§ØºØ© Ø¹Ø±Ø¨ÙŠØ© ÙˆØ³Ù„ÙŠÙ…Ø©.

              Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªÙ„Ø®ÙŠØµÙ‡:\n\n${text}` /* [124] */
            }]
          }) /* [124] */
        }); /* [124] */

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Ø®Ø·Ø£ Ù…Ù† API: ${response.status} ${response.statusText} - ${errorData.error?.message || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙØ§ØµÙŠÙ„'}`);
        }

        const data = await response.json(); /* [125] */
        let summary = "";
        if (data.choices && data.choices[0] && data.choices[0].message && data.choices[0].message.content) {
             summary = data.choices[0].message.content;
        } else {
            summary = "âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ø®Øµ Ø£Ùˆ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©.";
            console.error("Ø§Ø³ØªØ¬Ø§Ø¨Ø© ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø© Ù…Ù† API:", data);
        }

        // --- Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ù„Ø®Øµ ---
        summary = formatMathEquations(summary); // ØªÙ†Ø³ÙŠÙ‚ LaTeX Ø£ÙˆÙ„Ø§Ù‹ /* [125] */
        // ØªØ­ÙˆÙŠÙ„ Markdown Ø§Ù„Ø¨Ø³ÙŠØ· Ø¥Ù„Ù‰ HTML
        summary = summary
          .replace(/\*\*(.*?)\*\*/g, '<b>$1</b>') // Bold /* [126] */
          .replace(/\*(.*?)\*/g, '<i>$1</i>')   // Italic /* [126] */
          .replace(/_(.*?)_/g, '<u>$1</u>')   // Underline (Ù‚Ø¯ ÙŠØªØ¹Ø§Ø±Ø¶ Ù…Ø¹ Markdown Ø£Ø®Ø±Ù‰) /* [126] */
          .replace(/```(.*?)```/gs, '<pre><code>$1</code></pre>') // Code blocks
          .replace(/`(.*?)`/g, '<code>$1</code>');        // Inline code

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Ø¨Ø§ÙØªØ±Ø§Ø¶ Ø§Ø³ØªØ®Ø¯Ø§Ù… Markdown #)
        summary = summary.replace(/^### (.*$)/gim, '<h4 class="summary-subtitle">$1</h4>');
        summary = summary.replace(/^## (.*$)/gim, '<h3 class="summary-section-title">$1</h3>');
        summary = summary.replace(/^# (.*$)/gim, '<h2 class="summary-main-title">$1</h2>');

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù†Ù‚Ø·ÙŠØ© ÙˆØ§Ù„Ø±Ù‚Ù…ÙŠØ©
        summary = summary.replace(/^\s*[-*+] (.*$)/gim, '<li>$1</li>');
        summary = summary.replace(/^\s*\d+\. (.*$)/gim, '<li>$1</li>'); // ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ù„Ù€ li Ø£ÙŠØ¶Ù‹Ø§ Ù„Ù„ØªØ¨Ø³ÙŠØ·
        summary = summary.replace(/<ul>\s*<li>/g, '<ul><li>'); // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª
        summary = summary.replace(/<\/li>\s*<\/ul>/g, '</li></ul>');
        summary = summary.replace(/(<li>.*<\/li>)(?![\s\S]*<ul><li>)/g, '<ul>$1</ul>'); // Ø¥Ø¶Ø§ÙØ© ul Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
        summary = summary.replace(/<ol>\s*<li>/g, '<ol><li>'); // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª
        summary = summary.replace(/<\/li>\s*<\/ol>/g, '</li></ol>');
        summary = summary.replace(/(<li>.*<\/li>)(?![\s\S]*<ol><li>)/g, '<ol>$1</ol>'); // Ø¥Ø¶Ø§ÙØ© ol Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©

        summary = summary.replace(/\n/g, '<br>'); // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© /* [126] */
        // Ø¥Ø²Ø§Ù„Ø© <br> Ø§Ù„Ø²Ø§Ø¦Ø¯Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø£Ùˆ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
        summary = summary.replace(/<\/(h[2-4]|ul|ol|li|pre)><br>/gi, '</$1>');
        summary = summary.replace(/<(ul|ol)><br>/gi, '<$1>');
        summary = summary.replace(/<br><br>/g, '<br>'); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬Ø©

        // summary = enhanceSummaryStructure(summary); // Ù‚Ø¯ ØªÙƒÙˆÙ† Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…Ø¹Ù‚Ø¯Ø© ÙˆØªØªØ¹Ø§Ø±Ø¶ Ù…Ø¹ Markdown

        document.getElementById("summaryBox").innerHTML = summary; /* [127] */
        if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) { /* [127] */
          MathJax.typesetPromise([document.getElementById("summaryBox")]).then(() => { /* [127] */
            console.log('MathJax rendering complete for summary'); /* [127] */
          }).catch((err) => { /* [127] */
            console.error('MathJax rendering error:', err); /* [127] */
          });
        } /* [128] */
      } catch (error) { /* [128] */
        document.getElementById("summaryBox").innerHTML = `âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù„Ø®Øµ: ${error.message}`; /* [128] */
        console.error("Ø®Ø·Ø£ ØªÙ„Ø®ÙŠØµ Ø§Ù„Ù†Øµ:", error); /* [129] */
      }
    }

    function formatMathEquations(text) {
        // Ø£ÙˆÙ„Ø§Ù‹ØŒ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø© (Block)
        text = text.replace(/\\\[([\s\S]*?)\\\]/gs, function(match, equation) { /* [129] */
            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ ØªØ§Ø¬Ø§Øª HTML Ù‚Ø¯ ØªÙƒÙˆÙ† ØªØ³Ù„Ù„Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©
            equation = equation.replace(/<[^>]*>/g, '').trim(); /* [129] */
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ <br> Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©
            equation = equation.replace(/<br\s*\/?>/gi, ' ');
            // Ø¥Ø¶Ø§ÙØ© Ø­Ø§ÙˆÙŠØ© Ø®Ø§ØµØ© Ù„Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ù…Ù†ÙØµÙ„Ø©
            return `<div class="math-container">\\[${equation}\\]</div>`; /* [129] */
        });
        // Ø«Ø§Ù†ÙŠØ§Ù‹ØŒ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø³Ø·Ø±ÙŠØ© (Inline)
        text = text.replace(/\\\((.*?)\\\)/gs, function(match, equation) { /* [130] */
            equation = equation.replace(/<[^>]*>/g, '').trim(); /* [130] */
            equation = equation.replace(/<br\s*\/?>/gi, ' ');
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… span Ù…Ø¹ ÙƒÙ„Ø§Ø³ Ø®Ø§Øµ Ù„Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø³Ø·Ø±ÙŠØ©
            return `<span class="latex">\\(${equation}\\)</span>`; /* [130] */
        });
        return text; /* [131] */
    }


    // ÙŠÙ…ÙƒÙ† ØªØ¨Ø³ÙŠØ· Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© Ø£Ùˆ Ø¥Ø²Ø§Ù„ØªÙ‡Ø§ Ø¥Ø°Ø§ Ø§Ø¹ØªÙ…Ø¯Ù†Ø§ Ø¹Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Markdown Ù…Ù† API
    /*
    function enhanceSummaryStructure(summary) {
      let enhanced = summary;
      // Ù‡Ø°Ù‡ Ø§Ù„ØªØ¹Ø§Ø¨ÙŠØ± Ø§Ù„Ù†Ù…Ø·ÙŠØ© Ù‚Ø¯ ØªÙƒÙˆÙ† Ù‡Ø´Ø© ÙˆØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ÙŠÙ† Ø¬Ø¯Ø§Ù‹
      enhanced = enhanced.replace(/<br><br>(\d+\..*?)<br>/g, '<div class="summary-section"><div class="summary-title">$1</div>');
      enhanced = enhanced.replace(/<br><br>(?=<div class="summary-section">)/g, '</div>'); // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚
      enhanced += '</div>'; // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±
      enhanced = enhanced.replace(/(Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†|Ù‚Ø§Ù†ÙˆÙ†|Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©|Ù…Ø¹Ø§Ø¯Ù„Ø©)(.*?):<br>/g, '<div class="summary-laws"><div class="law-title">$1$2:</div>');
      enhanced = enhanced.replace(/<br><br>(?!\s*<div class="summary-laws">)/g, '</div><br>'); // Ø¥ØºÙ„Ø§Ù‚ Ù‚Ø³Ù… Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†
      return enhanced;
    }
    */

    function saveNote() {
      if (!isPlayerReady()) {
        // ØªØºÙŠÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„ØªÙƒÙˆÙ† Ø£ÙˆØ¶Ø­ Ù‚Ù„ÙŠÙ„Ø§Ù‹
        alert("âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­ÙØ¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ø§Ù„Ø¢Ù†. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ¬Ø§Ù‡Ø²ÙŠØªÙ‡."); /* [133] */
        return; /* [134] */
      }
      try {
        let currentTime = player.getCurrentTime(); /* [134] */
        let noteText = document.getElementById("noteText").value; /* [135] */

        if (noteText.trim() !== "") { /* [135] */
          notes.push({ time: currentTime, text: noteText }); /* [135] */
          updateNotesList(); /* [136] */
          document.getElementById("noteText").value = ""; /* [136] */
          console.log("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª:", currentTime); /* [136] */
        } else { /* [137] */
          alert("âŒ ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ù…Ù„Ø§Ø­Ø¸Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸."); /* [137] */
        } /* [138] */
      } catch (e) { /* [138] */
        console.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©:", e); /* [138] */
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©"); /* [139] */
      }
    }

    function updateNotesList() {
      let notesList = document.getElementById("notesList"); /* [139] */
      notesList.innerHTML = ""; /* [140] */

      // ÙØ±Ø² Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª
      notes.sort((a, b) => a.time - b.time);

      notes.forEach((note, index) => { /* [140] */
        let listItem = document.createElement("li"); /* [140] */
        listItem.innerHTML = `
            <span><b>[${formatTime(note.time)}]</b> ${escapeHtml(note.text)}</span>
            <div>
                <button class="control-btn" style="padding: 5px 10px; font-size: 14px;" onclick="jumpTo(${note.time})">ğŸ”— Ø§Ù†ØªÙ‚Ù„</button>
                <button class="clear-search-btn" style="padding: 5px 10px; font-size: 14px; background-color: #6c757d;" onclick="deleteNote(${index})">ğŸ—‘ Ø­Ø°Ù</button>
            </div>
        `;
        // Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        listItem.style.display = "flex";
        listItem.style.justifyContent = "space-between";
        listItem.style.alignItems = "center";
        notesList.appendChild(listItem); /* [140] */
      });
    } /* [141] */

     // Ø¯Ø§Ù„Ø© Ù„Ø­Ø°Ù Ù…Ù„Ø§Ø­Ø¸Ø©
    function deleteNote(index) {
        if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ\n"${notes[index].text.substring(0, 50)}..."`)) {
            notes.splice(index, 1);
            updateNotesList();
            console.log("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø±Ù‚Ù…:", index);
        }
    }

    function jumpTo(time) {
      if (!isPlayerReady()) {
        alert("âŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ÙˆØ¬Ø§Ù‡Ø²ÙŠØªÙ‡"); /* [141] */
        return; /* [142] */
      }
      try {
        player.seekTo(time, true); /* [142] */
        // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªÙˆÙ‚ÙÙ‹Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ù‚ÙØ²
        if (player.getPlayerState() !== YT.PlayerState.PLAYING) { /* [143] */
            player.playVideo(); /* [143] */
            // isPlaying Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© onPlayerStateChange
        } /* [144] */
        console.log("ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª:", time); /* [144] */
      } catch (e) { /* [145] */
        console.error("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©:", e); /* [145] */
        alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©"); /* [146] */
      }
    }

    function formatTime(seconds) {
      seconds = Math.max(0, seconds); // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙˆÙ‚Øª Ù„ÙŠØ³ Ø³Ø§Ù„Ø¨Ù‹Ø§
      let min = Math.floor(seconds / 60); /* [146] */
      let sec = Math.floor(seconds % 60); /* [147] */
      return `${min}:${sec < 10 ? "0" : ""}${sec}`; /* [147] */
    } /* [148] */

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode"); /* [148] */
      // Ù„Ø§ ØªØ­ØªØ§Ø¬ Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø­Ø« Ù‡Ù†Ø§ØŒ ÙÙ‚Ø· Ø§Ù„ÙˆØ¶Ø¹ ÙŠØªØºÙŠØ±
      // const searchText = document.getElementById("searchText").value;
      // if (searchText && searchText.trim() !== "") {
      //   searchInText();
      // }

      // Ø¥Ø¹Ø§Ø¯Ø© Ø¹Ø±Ø¶ MathJax Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø£Ù„ÙˆØ§Ù†Ù‡
      if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) { /* [150] */
        MathJax.typesetPromise().then(() => { /* [150] */
          console.log('MathJax rendering complete after dark mode toggle'); /* [150] */
        }).catch((err) => { /* [150] */
          console.error('MathJax rendering error:', err); /* [150] */
        });
      } /* [151] */
    }

    // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    loadYouTubeAPI(); /* [151] */

    // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„ØªØ´ØºÙŠÙ„/Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¨Ø¯Ø¦ÙŠÙ‹Ø§ Ù„ÙŠØ¹ÙƒØ³ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… Ø§Ù„Ø¬Ø§Ù‡Ø²ÙŠØ©
    document.addEventListener('DOMContentLoaded', () => {
        updatePlayPauseButton();
    });

  </script>
</body>
</html>